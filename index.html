<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MAKMUS — Mémoire & Vérité</title>
    <link rel="icon" type="image/png" href="https://i.postimg.cc/x88LbhZp/2_20251224_213424_0001.png">
    <link href="https://fonts.googleapis.com/css2?family=Libre+Baskerville:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7567982675325882"
     crossorigin="anonymous"></script>
    <meta name="google-adsense-account" content="ca-pub-7567982675325882">
</head>
<body>

<div class="full-menu" id="fullMenu">
        <div class="menu-header">
            <div class="menu-logo">MAKMUS</div>
            <span class="close-menu" id="closeMenu">&times; FERMER</span>
        </div>
        <div class="menu-content">
            <div class="menu-search">
                <input type="text" id="menuSearchInput" placeholder="RECHERCHER DANS LES ARCHIVES...">
                <button onclick="executeMenuSearch()">OK</button>
            </div>
            <div class="menu-grid">
                <div class="menu-section">
                    <h3>ACTUALITÉS</h3>
                    <ul>
                        <li><a href="#" onclick="fetchAllContent('top'); return false;">À la une</a></li>
                        <li><a href="#" onclick="fetchAllContent('top', 'RDC Congo'); return false;">RDC</a></li>
                        <li><a href="#" onclick="fetchAllContent('politics'); return false;">Politique</a></li>
                        <li><a href="#" onclick="fetchAllContent('world'); return false;">International</a></li>
                        <li><a href="#" onclick="fetchAllContent('environment'); return false;">Environnement</a></li>
                    </ul>
                </div>
                <div class="menu-section">
                    <h3>ÉCONOMIE & TECH</h3>
                    <ul>
                        <li><a href="#" onclick="fetchAllContent('business'); return false;">Business</a></li>
                        <li><a href="#" onclick="fetchAllContent('technology'); return false;">Technologies</a></li>
                        <li><a href="#" onclick="fetchAllContent('science'); return false;">Sciences</a></li>
                        <li><a href="#" onclick="fetchAllContent('top', 'crypto'); return false;">Crypto-monnaie</a></li>
                    </ul>
                </div>
                <div class="menu-section">
                    <h3>LOISIRS & SOCIÉTÉ</h3>
                    <ul>
                        <li><a href="#" onclick="fetchAllContent('sports'); return false;">Sports</a></li>
                        <li><a href="#" onclick="fetchAllContent('entertainment'); return false;">Culture & Musique</a></li>
                        <li><a href="#" onclick="fetchAllContent('health'); return false;">Santé</a></li>
                        <li><a href="#" onclick="fetchAllContent('lifestyle'); return false;">Style de vie / Food</a></li>
                        <li><a href="#" onclick="fetchAllContent('tourism'); return false;">Voyages</a></li>
                        <li><a href="jeux.html" class="nav-red">Jeux & Puzzles</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="top-bar">
        <div class="top-bar-content">
            <div id="live-date">---</div>
            <div class="auth-section"><button id="openModal">MON COMPTE</button></div>
        </div>
    </div>

    <header class="main-header">
        <div class="header-left">
            <div class="menu-toggle" id="btnOpenMenu">
                <span></span><span></span><span></span>
                <span class="menu-label">SECTIONS</span>
            </div>
        </div>
        <div class="logo-container">
            <a href="index.html">
                <img src="https://i.postimg.cc/7ZWdGrQc/Screenshot_2025_12_24_21_32_24_removebg_preview.png" alt="MAKMUS">
            </a>
        </div>
        <div class="header-right-spacer">
            <button class="btn-subscribe">ABONNEZ-VOUS POUR 1 $/SEMAINE</button>
        </div>
    </header>

    <nav class="nav-compact" id="navMenu">
        <ul>
            <li><a href="#" class="active" onclick="fetchAllContent('top'); return false;">À LA UNE</a></li>
            <li><a href="#" onclick="fetchAllContent('top', 'RDC Congo'); return false;">RDC</a></li>
            <li><a href="#" onclick="fetchAllContent('politics'); return false;">POLITIQUE</a></li>
            <li><a href="#" onclick="fetchAllContent('business'); return false;">ÉCONOMIE</a></li>
            <li><a href="#" onclick="fetchAllContent('sports'); return false;">SPORT</a></li>
            <li><a href="#" onclick="fetchAllContent('health'); return false;">SANTÉ</a></li>
            <li><a href="#" onclick="fetchAllContent('technology'); return false;">TECH</a></li>
            <li><a href="#" onclick="fetchAllContent('environment'); return false;">CLIMAT</a></li>
            <li><a href="jeux.html" class="nav-red">JEUX</a></li>
        </ul>
    </nav>

    <main class="newspaper-body">
        <div id="status-line" class="status-line">ÉDITION NATIONALE — ACTUALISATION EN TEMPS RÉEL</div>
        <section id="hero-zone"></section>
        <hr class="double-hr">
        <div class="news-grid" id="news-grid"></div>
    </main>

    <div class="modal" id="modalAccount">
        <div class="modal-box">
            <span class="close-btn" id="closeModal">&times;</span>
            <div class="modal-header">MAKMUS</div>
            <p>Accès réservé aux abonnés.</p>
            <input type="email" placeholder="Email">
            <input type="password" placeholder="Mot de passe">
            <button class="btn-submit">SE CONNECTER</button>
        </div>
    </div>
    <footer class="nyt-footer">
    <div class="footer-container">
        <div class="footer-brand">
            <img src="https://i.postimg.cc/7ZWdGrQc/Screenshot_2025_12_24_21_32_24_removebg_preview.png" alt="MAKMUS">
            <p>La vérité pour mémoire. L'excellence du journalisme en République Démocratique du Congo.</p>
        </div>

       <div class="footer-links-grid">
    <div class="footer-col">
        <h4>SECTIONS</h4>
        <ul>
        <li><a href="#" onclick="fetchAllContent('top'); return false;">À LA UNE</a></li>
        <li><a href="#" onclick="fetchAllContent('top', 'RDC Congo'); return false;">RDC</a></li>
        <li><a href="#" onclick="fetchAllContent('politics'); return false;">POLITIQUE</a></li>
        <li><a href="#" onclick="fetchAllContent('business'); return false;">ÉCONOMIE</a></li>
        <li><a href="#" onclick="fetchAllContent('sports'); return false;">SPORT</a></li>
        <li><a href="#" onclick="fetchAllContent('health'); return false;">SANTÉ</a></li>
        <li><a href="#" onclick="fetchAllContent('environment'); return false;">CLIMAT</a></li>
        <li><a href="#" onclick="fetchAllContent('tourism'); return false;">VOYAGES</a></li>
        <li><a href="jeux.html" class="nav-red">JEUX</a></li>
        </ul>
    </div>
    <div class="footer-col">
        <h4>AIDE</h4>
        <ul>
            <li><a href="#">Abonnements</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#">Publicité</a></li>
            <li><a href="#">Emploi</a></li>
            <li><a href="#">Makmus magazine</a></li>
            <li><a href="#">Makila Emmanuel Heritage </a></li>
            <li><a href="#">Météo </a></li>
            <li><a href="#">Makem screen Studio</a></li>
        </ul>
    </div>
    <div class="footer-col">
        <h4>SUIVEZ-NOUS</h4>
        <div class="social-links">
            <a href="#">FB</a>
            <a href="#">X</a>
            <a href="#">IG</a>
            <a href="#">YT</a>
        </div>
    </div>
</div>

        <div class="footer-bottom">
            <p>&copy; 2026 MAKMUS MEDIA GROUP. Tous droits réservés.</p>
            <div class="bottom-legal">
                <a href="#">Mentions Légales</a>
                <a href="#">Confidentialité</a>
                <a href="#">CGU</a>
            </div>
        </div>
    </div>
</footer>
  <script src="https://unpkg.com/pocketbase/dist/pocketbase.umd.js"></script>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script>
    // --- CONFIGURATION DYNAMIQUE & SUPABASE ---
    const BASE_URL = window.location.origin; 
    const SUPABASE_URL = 'https://logphtrdkpbfgtejtime.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxvZ3BodHJka3BiZmd0ZWp0aW1lIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAxNzY4MDYsImV4cCI6MjA4NTc1MjgwNn0.Uoxiax-whIdbB5oI3bof-hN0m5O9PDi96zmaUZ6BBio';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    const NEWAPI_PROXY = `${BASE_URL}/api/news`; 
    const CACHE_DURATION = 60 * 60 * 1000; 

    // --- GESTION DU MENU ---
    const btnOpenMenu = document.getElementById('btnOpenMenu');
    const btnCloseMenu = document.getElementById('closeMenu');
    const fullMenu = document.getElementById('fullMenu');
    
    if(btnOpenMenu) btnOpenMenu.onclick = () => { 
        fullMenu.classList.add('open'); 
        document.body.style.overflow = 'hidden'; 
    };
    
    if(btnCloseMenu) btnCloseMenu.onclick = () => { 
        fullMenu.classList.remove('open'); 
        document.body.style.overflow = 'auto'; 
    };

    window.executeMenuSearch = function() {
        const query = document.getElementById('menuSearchInput').value;
        if(query) {
            fetchAllContent('top', query);
            closeMenuUI();
        }
    }

    function closeMenuUI() {
        if(fullMenu && fullMenu.classList.contains('open')) {
            fullMenu.classList.remove('open');
            document.body.style.overflow = 'auto';
        }
    }

    // --- GESTION DE LA DATE ---
    function updateDate() {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        const liveDate = document.getElementById('live-date');
        if(liveDate) liveDate.textContent = new Date().toLocaleDateString('fr-FR', options).toUpperCase();
    }
    updateDate();

    // --- LOGIQUE DE RÉCUPÉRATION ---
    async function fetchAllContent(category = 'top', query = '') {
        window.scrollTo({ top: 0, behavior: 'smooth' });
        closeMenuUI();

        const status = document.getElementById('status-line');
        const newsCacheKey = `news_api_${category}_${query}`;
        const newsCacheTimeKey = `${newsCacheKey}_time`;
        const cachedNews = localStorage.getItem(newsCacheKey);
        const newsTimestamp = localStorage.getItem(newsCacheTimeKey);
        const now = new Date().getTime();

        try {
            if(status) status.textContent = "CHARGEMENT...";

            let sbQuery = supabaseClient.from('articles').select('*').order('created_at', { ascending: false });
            
            if (category !== 'top') {
                sbQuery = sbQuery.eq('category', category);
            }
            
            if (query) {
                sbQuery = sbQuery.or(`titre.ilike.%${query}%,description.ilike.%${query}%`);
            }

            const { data: myArticles, error: sbError } = await sbQuery;
            if (sbError) throw sbError;

            let worldNews = [];
            if (cachedNews && newsTimestamp && (now - newsTimestamp < CACHE_DURATION)) {
                worldNews = JSON.parse(cachedNews);
            } else {
                let newsUrl = `${NEWAPI_PROXY}?category=${category}`;
                if(query) newsUrl += `&q=${encodeURIComponent(query)}`;
                const newsRes = await fetch(newsUrl);
                const newsData = await newsRes.json();
                worldNews = newsData.results || [];

                localStorage.setItem(newsCacheKey, JSON.stringify(worldNews));
                localStorage.setItem(newsCacheTimeKey, now.toString());
            }

            renderAll({ myArticles: myArticles || [], worldNews }, query);

        } catch (e) { 
            console.error("Erreur:", e);
            if(status) status.textContent = "ERREUR DE CONNEXION.";
        }
    }

    // --- FONCTION D'AFFICHAGE (SANS ICONES DE PARTAGE) ---
    function renderAll(data, query) {
        const hero = document.getElementById('hero-zone');
        const grid = document.getElementById('news-grid');
        const status = document.getElementById('status-line');
        const { myArticles, worldNews } = data;

        const allPossible = [...myArticles, ...worldNews];
        const seenTitles = new Set();
        const uniqueArticles = allPossible.filter(art => {
            const t = (art.titre || art.title || "").trim().toLowerCase();
            if(!t || seenTitles.has(t)) return false;
            seenTitles.add(t);
            return true;
        });

        if (uniqueArticles.length === 0) {
            if(status) status.textContent = "AUCUNE INFO DISPONIBLE.";
            if(hero) hero.innerHTML = "";
            if(grid) grid.innerHTML = "";
            return;
        }

        // 1. HERO
        const h = uniqueArticles[0];
        const hTitle = h.titre || h.title;
        const hDesc = h.description || "";
        const hImg = h.image_url || h.image || "";
        const hIsLocal = h.id ? true : false;
        const hLink = hIsLocal ? `redaction.html?id=${h.id}` : (h.link || "#");

        renderHeroMarkup(hTitle, hDesc, hImg, hLink);

        // 2. GRILLE
        const gridArticles = uniqueArticles.slice(1, 13);
        if(grid) {
            grid.innerHTML = gridArticles.map(art => {
                const title = art.titre || art.title;
                const desc = art.description || "";
                const isLocal = art.id ? true : false;
                const link = isLocal ? `redaction.html?id=${art.id}` : (art.link || "#");
                const img = art.image_url || art.image || "";
                
                return `
                    <div class="article-card" onclick="window.location.href='${link}'">
                        ${img ? `<div class="card-img"><img src="${img}"></div>` : ''}
                        <div class="card-text">
                            <h3>${title}</h3>
                            <p class="card-desc">${desc.substring(0, 90)}...</p>
                        </div>
                    </div>`;
            }).join('');
        }

        if(status) status.textContent = query ? `RÉSULTATS : ${query.toUpperCase()}` : `ACTUALITÉS MISES À JOUR`;
    }

    function renderHeroMarkup(title, desc, img, link) {
        const heroZone = document.getElementById('hero-zone');
        if(!heroZone) return;

        heroZone.innerHTML = `
            <div class="hero-container" onclick="window.location.href='${link}'">
                <div class="hero-text">
                    <h1>${title}</h1>
                    <p>${desc ? desc.substring(0, 250) + '...' : ''}</p>
                    <button class="btn-read-more">LIRE LA SUITE →</button>
                </div>
                ${img ? `<div class="hero-img"><img src="${img}"></div>` : ''}
            </div>`;
    }

    window.onload = () => fetchAllContent('top');
</script>

</body>

</html>



